<!DOCTYPE HTML>
<html onkeypress="activateMouseShortcut(event);">
	<head>
		<title></title>
		<link href="animations.css" rel="stylesheet" />
		<style>
			html
			{
				background-image: url("Images/pokerTable.jpg");
				background-size: cover;
				background-repeat: no-repeat;
				overflow-y: hidden;
			}
			#gameLogHTML
			{
				position: absolute;
				top: 20vh;
				left: 30%;
				background-color: rgba(15, 15, 15, 0.7);
				color: white;
				overflow: auto;
				font: 18pt trebuchet ms;
				padding: 8px;
			}
			#gameLogTitleHTML
			{
				background-color: #2093e6;
				font: 32pt trebuchet ms;
				padding: 8px;
			}
			.appear
			{
				visibility: visible;
				animation-name: appear;
				animation-fill-mode: forwards;
				animation-duration: 1s;
			}
			.disappear
			{
				/*JS will asynchronously hide this*/
				animation-name: disappear;
				animation-fill-mode: forwards;
				animation-duration: 1s;
			}
			#playerStacheHTML
			{
				border-bottom: 5px solid black;
				position: absolute;
				left: 20%;
				width: 60%;
				top: 80vh;
				height: 16vh;
				overflow-x: scroll;
				overflow-y: hidden;
				white-space: nowrap;
			}
			#tempPlayBtnHTML
			{
				position: absolute;
				right: 5%;
				bottom: 5vh;
				border-radius: 50%;
				background-color: cornflowerblue;
				width: 5%;
				font: 24pt trebuchet ms;
			}
		</style>
		<script src="classes.js"></script>
		<script>
			function initialize() {
				gameLog = document.getElementById("gameLogHTML");
				gameLogLog = document.getElementById("gameLogLogHTML");
				gameLog.style.visibility = "hidden";
				playerStache = document.getElementById("playerStacheHTML");

				//Game Variables
				playBtnState = false;
				configPlayButton();

				//Creates the basic players and the card deck
				playerCount = 5;
				deck = new Deck();
				deck.generateDeck();
				deck.shuffleDeck();

				//The game log is stored in an array
				gameLogEvents = [];

				//Here we use an array to loop through AI functions with respect to their turn order. 
				playActions = [];
				bluffActions = [];

				//Store all the AI inside an array for easy access. The player is stored first
				playerArray = [];

				//Gets the game ready
				createPlayerCount();
			}
			function createPlayerCount() 
			{
				for (var i=0; i<playerCount; i++)
				{
					playerArray.push(new Player);
				}

				//Makes sure the first player is not AI
				playerArray[0].isAi = false; //Might remove for a better for loop

				distributeCard();
			}
			function distributeCard() //Hands out the cards
			{
				let number = 0;

				//While there are still cards in the deck, distribute them to the players
				while (deck.deck.length != 0)
				{
					//Remove the last card in the deck, and add the card to the player's hand.
					let removedCard = deck.deck.pop();
					playerArray[number].addCard(removedCard);

					//If the next player does not exist, go back to the first player and distribute the cards for them
					//If the next player does exist, distribute the cards to them
					if (playerArray[number + 1] == null)
					{
						number = 0;
					}
					else
					{
						number++;
					}
				}

				//Displays the player's hand in the frontend
				playerArray[0].updateHand(playerStache);
			}
			function activateMouseShortcut(e) //Different keys will prompt different commands to run based on mouse shortcuts
			{
				if (e.which == 101) //If the key pressed is E, open the log
				{
					if (gameLog.style.visibility == "hidden")
					{
						gameLog.style.visibility = "visible";

						gameLog.classList.add("appear");

						try
						{
							gameLog.classList.remove("disappear");
						}
						catch
						{
							console.log("First time initating log");
						}
					}
				}
				if (e.which == 102) //If the key pressed is F, close the log by making it invisible
				{
					if (gameLog.style.visibility == "visible")
					{
						gameLog.classList.add("disappear");

						window.setTimeout(function() {
							gameLog.style.visibility = "hidden";
							gameLog.classList.remove("appear");
						}, 1000);
					}
				}
			}
			function logPlay(text) //Logs a move in front of everything
			{
				let tempLi = document.createElement("li");
				tempLi.innerHTML = text;
				tempLi.style.color = "lightblue";

				gameLogLog.insertBefore(tempLi, gameLogLog.children[0]);
			}
			function logWipe() //Turns everything not in the last four turns white
			{
				for (var i=0; i<gameLogLog.children.length; i++)
				{
					gameLogLog.children[i].style.color = "white";
				}
			}

			//Player Turn
			function configPlayButton() //Configures the card play button depending on if it is the player's turn or if they can play the card
			{
				playBtnState = !playBtnState; //Changes the play button state

				if (playBtnState)
				{
					//Displays the card playing interface

					let tempPlayBtn = document.createElement("span");
					tempPlayBtn.id = "tempPlayBtnHTML";
					tempPlayBtn.innerHTML = "Play<br />Card";

					tempPlayBtn.addEventListener("click", function() {
						console.log(playerArray[0].checkNumSelected());
					})

					document.body.appendChild(tempPlayBtn);
				}
				else
				{
					//Displays the bullshit button
					return;
				}
			}
		</script>
	</head>
	<body onload="initialize();">
		<div id="gameLogHTML">
			<div id="gameLogTitleHTML">Game Log <br /></div>
			<ul id="gameLogLogHTML">
				<li>Player first accessed the game logs. Events in the last four turns are in blue</li>
			</ul>
		</div>

		<div id="playerStacheHTML">
		</div>
	</body>
</html>